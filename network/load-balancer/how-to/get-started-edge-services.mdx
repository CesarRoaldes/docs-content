---
meta:
  title: How to use a Load Balancer with Edge Services
  description: This page explains how to configure an Edge Services pipeline on your Load Balancer, enabling a caching service for faster and more efficient delivery.
content:
  h1: How to use a Load Balancer with Edge Services
  paragraph: This page explains how to configure an Edge Services pipeline on your Load Balancer, enabling a caching service for faster and more efficient delivery.
dates:
  validation: 2024-07-04
  posted: 2024-07-04
---

Edge Services is an additional feature for Scaleway Load Balancers and Object Storage buckets, currently available in [Public Beta](https://www.scaleway.com/en/betas/).

Creating an Edge Services pipeline for your Load Balancer helps to reduce load on your Load Balancer's backend servers. The origin configuration you define is used by Edge Services to connect to your Load Balancer and request content, which is then stored in the cache. Then, when your Load Balancer origin is accessed via its customizable Edge Services endpoint, the requested content is served from the cache (if present), without the need to fetch this content via the Load Balancer and its backend servers.

Edge Services lets you:

- Define the specific origin (Load Balancer, frontend port and host) for a given pipeline and its associated cache
- Choose the TTL for cached objects
- Purge the entire cache or specific cached objects at any time (cache invalidation)
- Customize your Edge Services pipeline endpoint using a subdomain of your own domain
- Add an SSL/TLS certificate so that Edge Services can serve content over HTTPS for your subdomain

Edge Services can be activated on top of any Load Balancer with a public IP address. Load Balancers with frontends/backends using both TCP and/or HTTP are supported. [Private Load Balancers](/network/load-balancer/reference-content/public-private-accessibility/#private-load-balancers) are not compatible with Edge Services.

## Edge Services concepts

TODO INSERT OVERALL DIAGRAM

### Pipeline

An Edge Services pipeline consists of an [origin](#origin) for which Edge Services requests and [caches](#cache) content, and an [endpoint](#endpoint) from which this content is served via Edge Services. The pipeline's endpoint can be customized with a user-defined [subdomain](#subdomain) and associated [certificate](#certificate) so that Edge Services can serve content over HTTPS. 

You can create one or more Edge Services pipelines for each of your Load Balancers. If creating multiple pipelines for the same origin Load Balancer, each one must be configured for a different frontend.

### Origin

The primary source from which an Edge Services pipeline retrieves and caches data. An origin consists of the [Load Balancer](#origin-load-balancer) and frontend port that Edge Services connects to to request content, and (optionally) a specified [host](#origin-host) associated with the Load Balancer, used in the HTTP request Host Header.

### Origin Load Balancer

The Load Balancer defined by the user as origin for a given Edge Services pipeline. The pipeline connects to this Load Balancer, on the specified frontend port to request content.

### Protocol

The protocol (HTTP or HTTPS) that the Edge Services pipeline should use when sending requests to the origin. HTTPS is recommended, but you should choose the protocol that corresponds with your Load Balancer setup.

### Origin host

The specific host for which Edge Services requests and caches data. This is an optional setting: when specified, this host (e.g. `mydomain.com`) is used in the HTTP Host Header when Edge Services requests data from the Load Balancer. If no origin host is specified, the Load Balancer's IP address is used in the Host Header. 

The origin host must be associated with the origin Load Balancer / its backend servers, and only one host may be set per pipeline. If your Load Balancer is in front of multiple hosts, you can create a separate Edge Services pipeline for each. Each host will therefore get its own Edge Services endpoint and cache.

### Cache

The storage location where Edge Services stores copies of content that it has retrieved from a given Load Balancer origin. When users request content from the Edge Services endpoint, it serves content directly from the cache wherever possible, in accordance with the caching rules defined by the user. This reduces load on the Load Balancer and its backend servers.

Note that if an object has a caching directive, the caching directive always takes precedence over any lifetime setting defined in Edge Services.

### Endpoint

The endpoint from which a given Edge Services pipeline can be accessed, e.g. `https://pipeline-id.svc.edge.scw.cloud`. When a client requests content from the Edge Services endpoint, it is served by Edge Services and its cache, rather than from the Load Balancer and its backend servers directly. Edge Services automatically manages redirection from HTTP to HTTPS

The endpoint can be customized with a user-defined subdomain, allowing you to replace the standardized endpoint with the subdomain of a domain you already own, e.g. `http://my-own-domain.com`. An associated [certificate](#certificate), and [CNAME record](#cname) will be required, in this case.

### Certificate

The SSL/TLS certificate for your subdomain to enable Edge Services to serve content over HTTPS, if you have customized your [Edge Services endpoint](#endpoint). You can choose between uploading your own certificate held in Scaleway Secret Manager, or letting Edge Services generate a fully-managed Let's Encrypt certificate.

### CNAME record

The CNAME record pointing your subdomain to the Edge Services endpoint, if you have customized your [Edge Services endpoint](#endpoint). This is necessary to ensure that traffic for your customized subdomain is correctly directed towards the Edge Services endpoint by DNS servers.

<Macro id="requirements" />

- A Scaleway account logged into the [console](https://console.scaleway.com)
- [Owner](/identity-and-access-management/iam/concepts/#owner) status or [IAM permissions](/identity-and-access-management/iam/concepts/#permission) allowing you to perform actions in the intended Organization
- A [Load Balancer](/network/load-balancer/how-to/create-load-balancer/)

## How to create an Edge Services pipeline

You can create one or more Edge Services pipelines for each of your Load Balancers. Each pipeline has its own [origin](#origin), [endpoint](#endpoint) and [cache](#cache). If you create multiple Edge Services pipelines for the same origin Load Balancer, each one must be configured for a different frontend.

Follow the steps below to create an Edge Services pipeline.

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click **create Edge Services pipeline**. The pipeline creation wizard displays.

    TODO SCREENSHOT

4. Configure the [origin](#origin) for this pipeline:
        - Select the **origin Load Balancer** from the dropdown list. The Edge Services pipeline will connect to this Load Balancer when requesting content.
        - Select a **frontend** associated with the origin Load Balancer from the dropdown list. The Edge Services pipeline will connect to the Load Balancer on this port when requesting content. We recommend that you select an HTTPS port, e.g. `443`.

        <Message type="tip">
        For Kubernetes Load Balancers, see our [dedicated documentation](#help-for-kubernetes-load-balancers) for help selecting the correct Load Balancer and frontend.
        </Message>

5. Define the protocol and origin host for this pipeline:
        - Select the protocol that Edge Services should use when making requests to the origin, either `HTTP` or `HTTPS` (recommended). Choose the protocol that corresponds with your Load Balancer setup.
        - Optionally, enter an [origin host](#origin-host) associated with your Load Balancer for this pipeline. When specified, this host replaces the Load Balancer IP address in the HTTP Host Header of the requests made from Edge Services to your Load Balancer.

6. Enter a name for this Edge Services pipeline, or leave the auto-generated name in place.

    Edge Services for Load Balancer is free during Public Beta. You will be notified before the service leaves beta and becomes billable.

7. Click **Create Edge Services pipeline** to finish.

Your pipeline is created and your are taken to its **Overview** page. The endpoint displays from which you can access your Load Balancer origin via Edge Services, e.g. `https://pipeline-id.edge.scw.cloud`

### Troubleshooting pipeline creation

If you see the message `Edge Services was unable to contact the host via the Load Balancer Please check your origin configuration settings and try again`, check the following elements of your configuration:

- **Protocol**: Ensure you did not select the wrong protocol, e.g. HTTP selected while the frontend chosen is configured to receive HTTPS, or the opposite.
- **Origin host**: Ensure that you entered the correct origin host, with no typos, for a host that exists behind the selected Load Balancer.
- **Load Balancer ACLs**: Ensure that there are no [ACLs](/network/load-balancer/how-to/create-manage-acls/) configured on your Load Balancer which are blocking traffic from Edge Services.

### Help for Kubernetes Load Balancers

If you are setting up an Edge Services pipeline for a [Kubernetes Kapsule](/containers/kubernetes) Load Balancer, follow these steps to determine which Load Balancer and frontend to configure for your pipeline:

1. Run `kubectl describe svc`.

    An output displays.

2. Locate the section of the output that relates to your LoadBalancer service. It should look something like this:

    ```
    Name:                     myloadbalancer
    Namespace:                default
    Labels:                   app=mydeployment
    Annotations:              service.beta.kubernetes.io/scw-loadbalancer-id: fr-par-1/a92de52e-262f-99f9-be66-5220003a2e42
    Selector:                 app=mydeployment
    Type:                     LoadBalancer
    IP Family Policy:         SingleStack
    IP Families:              IPv4
    IP:                       10.32.220.60
    IPs:                      10.32.220.60
    LoadBalancer Ingress:     51.159.25.111
    Port:                     http  8000/TCP
    TargetPort:               8000/TCP
    NodePort:                 http  32041/TCP
    Endpoints:                
    Session Affinity:         None
    External Traffic Policy:  Cluster
    ```
3. Find the `service.beta.kubernetes.io/scw-loadbalancer-id` annotation, and note your Load Balancer ID (e.g. `a92de52e-262f-99f9-be66-5220003a2e42`). Check your Load Balancer list in the [console](https://console.scaleway.com/load-balancer/lbs) to find the Load Balancer name that corresponds to this ID. This is the Load Balancer you should select for the Edge Services pipeline.

4. Find the **NodePort** line and note the port mentioned (in the case above, `32041`). In the [console](https://console.scaleway.com/load-balancer/lbs), find the frontend of the Load Balancer from step 3 that corresponds with this port. This is the frontend and port you should select for the Edge Services pipeline.

## How to edit an Edge Services pipeline origin

You can edit the protocol, origin host and name of an Edge Services pipeline as follows.

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline you want to edit. The **Overview** page for the pipeline displays.

4. In the top right corner, click **Edit**. A pop-up displays.

        TODO INSERT SCREENSHOT

5. Make the edits required. You can:
    - Change the **protocol**
    - Change the **origin host**
    - Change the pipeline **name**

6. Click **Save**.

## How to customize your Edge Services endpoint

### How to configure a custom domain

If you already own a domain, you customize your Edge Services pipeline endpoint with a subdomain of your choice.

For example, if you own `beautiful-domain.com`, you can customize the endpoint to be `whatever-i-want.beautiful-domain.com`. You must also add an SSL/TLS certificate so that Edge Services can securely serve your Load Balancer origin's content via HTTPS.

You cannot customize your endpoint with a primary domain directly (e.g. `beautiful-domain.com`), only with a subdomain of it.

The procedure for adding a customized endpoint is as follows:

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline whose endpoint you want to customize.

4. In the **Endpoint** panel, click **Configure domain**. The following screen displays:

    TODO SCREENSHOT

5. Set a subdomain from which your Load Balancer origin will be accessible via its Edge Services pipeline. You must already own the primary domain. For example, if you own `beautiful-domain.com`, choose any subdomain you like and enter `my-chosen-subdomain.beautiful-domain.com` into the box.

    <Message type="important">
    It is **not** possible to use only a root domain (aka primary domain or apex domain), you must use a subdomain. This is because CNAME records, essential to point your domain to your Edge Services endpoint, cannot by definition be created for root domains, only for subdomains.
    ✅ blog.example.com
    ❌ example.com
    </Message>

6. This step depends on whether the domain used in the previous step is managed with [Scaleway Domains and DNS](https://www.scaleway.com/en/docs/network/domains-and-dns/), or an external domain provider. Choose the appropriate tab below.

    <Tabs id="edge-cname">
    
        <TabsTab label="Domains and DNS">
        The domain you are using for Edge Services is considered to be managed with Scaleway Domains and DNS if:
        - You [registered the domain](/network/domains-and-dns/how-to/register-internal-domain/) with Domains and DNS, or
        - You [transferred an externally-registered domain](/network/domains-and-dns/how-to/transfer-external-domain/) to Domains and DNS

        If either of the above is true, Scaleway will auto-detect that the domain is managed by Domains and DNS, and a message will display confirming that you do not need to create a CNAME record. We will auto-generate the appropriate CNAME record in your domain's [DNS records](/network/domains-and-dns/how-to/manage-dns-records/), to point your subdomain to the Edge Services endpoint for your Load Balancer origin. This record is generated when you click `Customize domain` in step 8.

        You should not attempt to modify or delete the CNAME record, which will be visible among your [DNS records](/network/domains-and-dns/how-to/manage-dns-records/) in the Scaleway console.
        </TabsTab>

        <TabsTab label="External provider">
        Scaleway cannot itself create the appropriate CNAME record to point your subdomain to Edge Services if your domain is managed by an external provider. You must create the CNAME record yourself.

        Log into your domain provider, and locate the DNS settings for your domain. Create a new CNAME record pointing your subdomain to the Edge Services pipeline endpoint for your Load Balancer origin displayed in the Scaleway console. For help setting up CNAME records and troubleshooting any problems, [check out our dedicated documentation](TODO)

        Back in the Scaleway console, click the `Verify CNAME` button to check whether your CNAME record has been correctly configured. Edge Services will carry out a check, and if it is successful the following message displays:

        <Lightbox src="scaleway-cname-success.webp" alt="Verification passed: Your DNS record has been correctly configured" /> TODO CHECK

        If the check fails, an error message will display. See the documentation linked above for help troubleshooting such errors.
        </TabsTab>
    </Tabs>

7. Provide an SSL/TLS certificate for your subdomain so that Edge Services can serve traffic for it over HTTPS. You have three options for this:
    - Generate a free Let's Encrypt certificate, managed by Scaleway, including automatic renewals.
    - Select an existing certificate that you have stored in [Scaleway Secret Manager](/identity-and-access-management/secret-manager/quickstart/).
    - Manually import a certificate into Scaleway Secret Manager:
      - Enter a name for your certificate (alphanumeric characters only)
      - Optionally, add tags by typing each tag and then pressing enter
      - Copy and paste the full PEM-formatted certificate chain into the box.
      Your certificate will be automatically stored in Secret Manager and [billed accordingly](TODO LINK).

    <Message type="tip">
    For help with SSL/TLS certificates for Edge Services, and/or dealing with any errors you encounter importing a certificate into Secret Manager, see our [dedicated documentation](TODO LINK).
    </Message>

8. Click **Customize domain** to finish.

Your customized domain is set up, and you are returned to the Edge Services dashboard. The customized domain displays in the Endpoint panel. When you access your Load Balancer origin through this domain, its content will be served via Edge Services.

<Message type="note">
If you chose to generate a managed Let's Encrypt certificate, allow a few minutes for the certificate to finish creating. When the process is complete and the certificate is ready, you will see a green status light for **SSL/TLS certificate** on your endpoint dashboard.

<Lightbox src="scaleway-edge-services-certificate-complete.webp" alt="" /> TODO CHECK

</Message>

### How to edit your customized domain or its certificate

After customizing your domain, you can edit it (or its certificate) at any time as follows:

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline whose endpoint you want to customize.

    <Lightbox src="scaleway-edge-services-customised.webp" /> TODO CHECK

4. In the **Endpoint** panel, click **Edit**. The **Edit Domain** screen displays.

5. Edit the subdomain as desired - do not forget to also set up a new CNAME record, if necessary.

6. Edit your certificate options as required - choose to generate a managed Let's Encrypt certificate, managed by Scaleway including automatic renewals, or select a different certificate from Secret Manager, or manually import a new certificate for your custom domain.

7. Click **Edit domain** to finish.

### How to reset your customized domain to the original Edge Services endpoint

Even though the original Edge Services endpoint (e.g. `https://pipeline-id.svc.edge.scw.cloud`) will continue to work after you add a customized domain, you can choose to remove your customized domain completely and go back to the original Edge Services endpoint only. This is done via the reset function:

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline whose endpoint you want to reset.

    <Lightbox src="scaleway-edge-services-customised.webp" /> TODO CHECK

4. In the **Endpoint** panel, click **Reset**.

    A screen displays warning you that this will reset the pipeline's domain back to the default Edge Services endpoint. Edge Services will consider your customized subdomain as unknown. You should also remember to:
        - Delete your CNAME record from your domain provider, unless your domain is managed with Scaleway Domains and DNS, in which case we take care of deletion for you.
        - Delete any SSL/TLS certificates you imported into Secret Manager (if no longer required elsewhere, so that you are no longer billed for it). If you generated a managed Let's Encrypt certificate however, Scaleway takes care of the deletion for you.

5. Click **Reset domain** to finish.

## How to configure your cache

The cache feature allows you to cache your Load Balancer origin's content with Edge Services. This means that content can be served directly to users from Edge Services' servers, enhancing performance.

You can disable and enable caching at will, as well as control the lifetime of an object in the cache. You can also purge your entire cache, or specific objects within it. A log is displayed to help you track your purge events.

### How to enable your cache

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline you want to enable caching on.

    <Lightbox src="scaleway-edge-services-customised.webp" /> TODO CHECK

4. In the **Cache** panel, use the <Icon name="toggle" /> icon to enable the cache.

    The **Lifetime** configuration box displays. This enables you to define, in seconds, how long an object can be stored in the cache before it must be retrieved freshly from the Load Balancer origin.

    <Lightbox src="scaleway-edge-services-cache.webp" /> TODO CHECK

    <Message type="tip">
    As an example, a value of 0 means that objects will not be cached, unless they have a separately-defined caching directive. Note that in any case, if an object has a caching directive, the caching directive always takes precedence over any lifetime setting defined here in Edge Services.
    </Message>

5. Leave the default value of 1 hour in place, or enter another value.

The cache is now enabled.

### How to purge all objects from your cache

This clears all objects from your cache. Afterwards, Edge Services will retrieve fresh copies from the Load Balancer origin before it stores them again in the cache.

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline whose cache you want to purge.

4. In the **Purge cache** panel, click **Purge all**.

    <Lightbox src="scaleway-edge-services-purge-cache.webp" /> TODO CHECK

    A screen displays warning you that your cache will be emptied, and Edge Services will have to retrieve objects from your Load Balancer origin before re-caching them.
        
5. Click **Purge cache** to confirm.

### How to purge specific objects from your cache

This allows you to specify the precise objects that you want to clear from the cache. Afterwards, Edge Services will retrieve fresh copies from the Load Balancer origin before it stores them again in the cache.

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline whose cache you want to purge.

4. In the **Purge cache** panel, click **Purge by object**.

    <Lightbox src="scaleway-edge-services-purge-cache.webp" /> TODO CHECK
        
    A screen displays prompting you to enter the path of each object you want to purge from the cache.

    <Lightbox src="scaleway-edge-services-purge-object.webp" /> TODO CHECK

5. Enter the path of each object you want to purge. You can purge a maximum of 5 objects at a time.

      <Message type="tip">

      The path for each object should be defined from the root and must start with a slash, e.g. `/videos/my-video.mp4`.

      You **cannot** purge entire directories by simply specifying the path to the directory, e.g. `/videos`. Purging objects must done strictly object-by-object, so `/videos/my-video1.mp4`, `/videos/my-video2.mp4`, `/videos/my-video3.mp4` etc. Watch this space for updates to this feature in the future.
      </Message>

6. Click **Purge objects from cache**

    The specified objects are purged from your cache and you are returned to the Edge Services dashboard.

### How to disable your cache

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline whose cache you want to disable.

4. In the **Cache** panel, use the <Icon name="toggle" /> icon to disable the cache.

    A pop-up displays, asking you to confirm the action.

5. Click **Disable cache**.

    Your cache is purged and disabled. Edge Services will now serve content by fetching it from your Load Balancer origin directly. If you reenable your cache at a later point, you will begin with an empty cache.

## How to monitor Edge Services with Scaleway Cockpit

You can view your Edge Services metrics via [Scaleway Cockpit](/observability/cockpit/quickstart/). This allows you to monitor your ingress, egress, request rate and cache hit ratio as well as other metrics, in a convenient managed Grafana dashboard.

Access your Edge Services dashboard in the Scaleway console via the shortcut in the Edge Services tab of the pipeline in question. Note that you will first need to [create a Grafana user and credentials](https://www.scaleway.com/en/docs/observability/cockpit/how-to/retrieve-grafana-credentials/).

### Understanding the dashboard

The Grafana dashboard presents a number of different metrics. Use the drop-down in the top left to select which pipeline and origin to view Edge Services metrics for, and the time range drop-down in the top right to modify the time period to apply to the metrics.

<Lightbox src="scaleway-edge-services-metrics.webp" alt="" />

- **Request rate**: The number of requests made to Edge Services per second, for the specified origin, averaged over the specified time period.
- **Cache hit ratio**: The percentage of requests served from Edge Services' cache, compared to the total number of requests in total to Edge Services for this origin, over the specified time period.
- **Cache HIT/MISS**: A visual representation of the ratio of cache hits to misses, for the specified origin, over the specified time period.
    - **Cache hit line**: The number of requests per second made to Edge Services for this origin, which were served directly from its cache.
    - **Cache miss line**: The number of requests per second made to Edge Services for this origin, where the content was fetched from the origin rather than the cache. 
    - **Total line**: The number of requests per second made to Edge Services for this origin.

- **Egress (to client)**: The total volume of data served to clients from Edge Services, for the specified origin, over the specified time period.
- **Ingress (from origin)**: The total volume of data from the origin server to Edge Services over the specified time period. This represents the traffic that occurs when Edge Services retrieves content from the origin server in order to fulfill requests.
- **Edge Services throughput**: A visual representation of the rate of data transfer for the specified origin with Edge Services over the specified time period.
    - **Output bitrate line**: The rate at which data is being delivered from Edge Services to end users.
    - **Input bitrate line**: The rate at which Edge Services is fetching data from the origin server. Peaks in this line may represent times when Edge Services had to fetch content from the origin server, rather than being able to serve it directly from its own cache.

- **Requests served**: The total number of requests that Edge Services has successfully served, for the specified origin, over the specified time period.
- **Edge Services response statuses**: A visual representation of the distribution of HTTP response statuses for requests served by Edge Services over the specified time period. Consult [the full list of HTTP status codes](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes) for more information if necessary.

- **Request origin country**: The proportion of requests (to Edge Services for the specified origin over the specified time period) originating from different countries.
- **End users location**: A visual representation of where Edge Services end users have been making requests from geographically.

## How to delete an Edge Services pipeline

You can delete an Edge Services pipeline at any time via the following procedure:

1. Click **Load Balancers** in the **Network** section of the Scaleway console side menu. The list of your Load Balancers displays.

2. Click the **Edge Services** tab.

3. Click the Edge Services pipeline you want to delete.

4. In the **Delete Edge Services pipeline** panel at the bottom of the screen, click **Delete Edge Services pipeline**.

    A pop-up displays, informing you that thee Edge Services pipeline will be deleted, and the Load Balancer origin will no longer b accessible via its Edge Services endpoint. Any files stored in the Edge Services cache will be removed.
    
    <Message type="tip">
    If you customized your Edge Services pipeline endpoint with your own subdomain, remember to:
        - Delete your CNAME record from your domain provider, unless your domain is managed with Scaleway Domains and DNS, in which case we take care of deletion for you.
        - Delete any SSL/TLS certificates you imported into Secret Manager (if no longer required elsewhere, so that you are no longer billed for it). If you generated a managed Let's Encrypt certificate however, Scaleway takes care of the deletion for you.
    </Message>

5. Click **Confirm**. CHECK

    The Edge Services pipeline is deleted. You can create a new pipeline for this Load Balancer origin again at any time, but you will need to reconfigure any custom domains, and the cache will initially be empty.